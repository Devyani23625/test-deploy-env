name: Release Pipeline

on:
  workflow_dispatch:

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - run: |
          echo "Simulating build..."
          # Uncomment to simulate failure
          # exit 1

  trigger-deploy:
    needs: release
    if: always()
    uses: ./.github/workflows/deploy.yml
    with:
      rollback: ${{ needs.release.result == 'failure' }}
